function drawChart(e){e=d3.entries(e);var t=200,a=d3.select("#theGreatsChart").selectAll("div.greats").data(e).enter().append("div").attrs({class:function(e){return e.key+" greats hidden"}});smScreen||a.styles({left:function(e){var t=d3.entries(e.value.years),a=t[t.length-1],r=a.key>1930?-300:100;return xScaleB(parseFloat(a.key))+r+"px"},top:function(e){var t=d3.entries(e.value.years),a=t[t.length-1];return yScaleB(parseFloat(a.value.ptsTot))-75+"px"},width:"200px"}),a.append("h3").text(function(e){return e.value.name}),a.selectAll("div").data(function(e){return d3.entries(e.value.years)}).enter().append("div").attrs({class:function(e){return e.key+" yearRank darkGray"}}).html(function(e){var t;return t=e.value.rank<4?'<img class="medal" src="images/medal-0'+e.value.rank+'.svg" />':'<span class="rank liteGray"> '+e.value.rank+"</span>",e.key+t});var r=d3.select("#theGreatsChart").append("svg").attr("width",widthB).attr("height",heightB),n=r.selectAll("g.arc").data(e).enter().append("g").attr("class",function(e){return e.key+" arc"}).on("mouseover",cyclistOn()).on("mouseout",cyclistOff()).on("mouseup",cyclistOnClick());n.append("path").datum(function(e){return years=d3.entries(e.value.years),years}).attr("class","line").attr("d",line);var i=n.append("g").datum(function(e){var t=d3.entries(e.value.years),a=t[t.length-1];return[e.value.name,a]}).attr("transform",function(e){return"translate("+xScaleB(e[1].key)+","+yScaleB(e[1].value.ptsTot)+")"});i.append("circle").attrs({class:"terminal black",cx:0,cy:0,r:function(){return smScreen?4:2}});var s={left:6,top:3},l={left:12,top:6};i.append("text").attrs({class:function(e){return e[1].value.ptsTot>1625?"darkText riderName top25":"darkText riderName hidden"},x:function(){return smScreen?l.left:s.left},y:function(){return smScreen?l.top:s.top}}).text(function(e){return e[0]}),r.append("g").call(xAxisB).attr("class","x axis").attr("transform","translate(0,"+heightB+")"),r.append("g").call(yAxisB).attr("class","y axis")}function greatsClick(){clickedB?(clearClick(),clickedB=!1):clickedB=!0}function cyclistOnClick(){return function(e){d3.select("div."+e.key+".greats").classed("hidden",!1),d3.selectAll("g.arc").style("opacity",".4"),highlight(d3.select(this))}}function clearClick(){d3.selectAll("g.arc").style("opacity",".8").select(".line").transition().duration(dura).styles({"stroke-width":"1px",stroke:"#f78056"}),d3.selectAll("div.greats").classed("hidden",!0)}function highlight(e){e.style("opacity",1),e.select(".line").transition().duration(dura).styles({"stroke-width":"2px",stroke:"#0f0f0f"});var t=e.select(".riderName");t.classed("hidden")&&t.classed("hidden",!1)}function cyclistOn(){return function(e){if(!clickedB){highlight(d3.select(this))}}}function cyclistOff(){return function(e){if(!clickedB){var t=d3.select(this);d3.selectAll("g.arc").style("opacity",".8"),t.style("opacity",.8),t.select(".line").transition().duration(dura).styles({"stroke-width":"1px",stroke:"#f78056"});var a=t.select(".riderName");a.classed("hidden")||a.classed("top25")||a.classed("hidden",!0)}}}var widthB,heightB,gmargin;smScreen?(gmargin={top:40,right:0,bottom:20,left:0},widthB=2200-gmargin.left-gmargin.right,heightB=1e3-gmargin.top-gmargin.bottom):(gmargin={top:20,right:0,bottom:5,left:0},widthB=1100-gmargin.left-gmargin.right,heightB=600-gmargin.top-gmargin.bottom);var xScaleB=d3.scaleLinear().range([0,widthB]).domain([1896,2016]),yScaleB=d3.scaleLinear().range([0,heightB]).domain([5e3,0]),xAxisB=d3.axisBottom().tickFormat(d3.format("d")).tickValues([1896,2016]).scale(xScaleB),yAxisB=d3.axisRight().tickValues([500,1e3,1500,2e3,2500,3e3,3500,4e3]).scale(yScaleB),line=d3.line().x(function(e){return xScaleB(+e.key)}).y(function(e){return yScaleB(e.value.ptsTot)}),dura=50;d3.json("data/top10percent.json",drawChart);var clickedB=!1;